<?php

declare(strict_types=1);

namespace Mittwald\ApiClient\Generated\V2\Clients\Article;

use GuzzleHttp\Client;
use GuzzleHttp\Exception\GuzzleException;
use GuzzleHttp\Psr7\Request;
use Mittwald\ApiClient\Error\UnexpectedResponseException;
use Mittwald\ApiClient\Generated\V2\Clients\Article\GetArticle\GetArticleDefaultResponse;
use Mittwald\ApiClient\Generated\V2\Clients\Article\GetArticle\GetArticleNotFoundResponse;
use Mittwald\ApiClient\Generated\V2\Clients\Article\GetArticle\GetArticleOKResponse;
use Mittwald\ApiClient\Generated\V2\Clients\Article\GetArticle\GetArticleRequest;
use Mittwald\ApiClient\Generated\V2\Clients\Article\GetArticle\GetArticleTooManyRequestsResponse;
use Mittwald\ApiClient\Generated\V2\Clients\Article\ListArticles\ListArticlesDefaultResponse;
use Mittwald\ApiClient\Generated\V2\Clients\Article\ListArticles\ListArticlesOKResponse;
use Mittwald\ApiClient\Generated\V2\Clients\Article\ListArticles\ListArticlesRequest;
use Mittwald\ApiClient\Generated\V2\Clients\Article\ListArticles\ListArticlesTooManyRequestsResponse;

/**
 * Client for Article API
 *
 * The article API allows you to read article information.
 *
 * DO NOT EDIT; this class was generated by the mittwald/api-client-builder package
 * (https://github.com/mittwald/api-client-php-builder). Please make any changes
 * there.
 *
 * @generated
 * @see https://github.com/mittwald/api-client-php-builder
 */
class ArticleClientImpl implements ArticleClient
{
    private Client $client;

    public function __construct(Client $client)
    {
        $this->client = $client;
    }

    /**
     * Get an Article.
     *
     * @see https://developer.mittwald.de/reference/v2/#tag/Article/operation/article-get-article
     * @throws GuzzleException
     * @throws UnexpectedResponseException
     * @param GetArticleRequest $request An object representing the request for this operation
     * @return GetArticleOKResponse The Article object
     */
    public function getArticle(GetArticleRequest $request): GetArticleOKResponse
    {
        $httpRequest = new Request(GetArticleRequest::method, $request->buildUrl());
        $httpResponse = $this->client->send($httpRequest, $request->buildRequestOptions());
        if ($httpResponse->getStatusCode() === 200) {
            return GetArticleOKResponse::fromResponse($httpResponse);
        }
        throw new UnexpectedResponseException(match ($httpResponse->getStatusCode()) {
            404 => GetArticleNotFoundResponse::fromResponse($httpResponse),
            429 => GetArticleTooManyRequestsResponse::fromResponse($httpResponse),
            default => GetArticleDefaultResponse::fromResponse($httpResponse),
        });
    }

    /**
     * List Articles.
     *
     * @see https://developer.mittwald.de/reference/v2/#tag/Article/operation/article-list-articles
     * @throws GuzzleException
     * @throws UnexpectedResponseException
     * @param ListArticlesRequest $request An object representing the request for this operation
     * @return ListArticlesOKResponse Object containing the list of Articles
     */
    public function listArticles(ListArticlesRequest $request): ListArticlesOKResponse
    {
        $httpRequest = new Request(ListArticlesRequest::method, $request->buildUrl());
        $httpResponse = $this->client->send($httpRequest, $request->buildRequestOptions());
        if ($httpResponse->getStatusCode() === 200) {
            return ListArticlesOKResponse::fromResponse($httpResponse);
        }
        throw new UnexpectedResponseException(match ($httpResponse->getStatusCode()) {
            429 => ListArticlesTooManyRequestsResponse::fromResponse($httpResponse),
            default => ListArticlesDefaultResponse::fromResponse($httpResponse),
        });
    }
}
